<section class="new-arrivals full-width">
  <div class="na__inner">
    <div class="na__head">
      <div class="na__head-left">
        <h2 class="na__title">{{ section.settings.heading | default: 'New Arrivals' }}</h2>
        {% if section.settings.subheading != blank %}
          <p class="na__subtitle">{{ section.settings.subheading }}</p>
        {% endif %}
      </div>
      <div class="na__head-ctas">
        {% if section.settings.shop_women_link != blank %}
          <a class="na__cta" href="{{ section.settings.shop_women_link }}">{{ section.settings.shop_women_label | default: 'SHOP WOMENS' }}</a>
        {% endif %}
        {% if section.settings.shop_men_link != blank %}
          <a class="na__cta" href="{{ section.settings.shop_men_link }}">{{ section.settings.shop_men_label | default: 'SHOP MENS' }}</a>
        {% endif %}
      </div>
    </div>

    <div class="na__tabs" role="tablist">
        <button class="na__tab is-active" data-tab="men" role="tab" aria-selected="true">{{ section.settings.men_label | default: 'Men' }}</button>
        <button class="na__tab" data-tab="women" role="tab" aria-selected="false">{{ section.settings.women_label | default: 'Women' }}</button>
        <button class="na__tab" data-tab="accessories" role="tab" aria-selected="false">{{ section.settings.accessories_label | default: 'Accessories' }}</button>
    </div>
    </div>

    {% assign menColl = collections[section.settings.men_collection] %}
    {% assign womenColl = collections[section.settings.women_collection] %}
    {% assign accColl = collections[section.settings.accessories_collection] %}
    {% assign men_count = menColl.products_count | default: 0 | plus: 0 %}
    {% assign women_count = womenColl.products_count | default: 0 | plus: 0 %}
    {% assign acc_count = accColl.products_count | default: 0 | plus: 0 %}

    <div class="na__panels">
      <div class="na__panel is-active" data-panel="men">
        {% if menColl and men_count > 0 %}
        <div class="na__grid">
          {% for product in menColl.products limit: section.settings.limit %}
          <a class="na-card" href="{{ product.url }}">
            {% if product.featured_image %}
              {% render 'image', class: 'na-card__img', image: product.featured_image, width: 600, height: 750, crop: 'center' %}
            {% endif %}
            <div class="na-card__meta">
              <p class="na-card__title">{{ product.title }}</p>
              <p class="na-card__price">{{ product.price | money }}</p>
            </div>
          </a>
          {% endfor %}
        </div>
        {% else %}
          <p>No products found.</p>
        {% endif %}
      </div>

      <div class="na__panel" data-panel="women">
        {% if womenColl and women_count > 0 %}
        <div class="na__grid">
          {% for product in womenColl.products limit: section.settings.limit %}
          <a class="na-card" href="{{ product.url }}">
            {% if product.featured_image %}
              {% render 'image', class: 'na-card__img', image: product.featured_image, width: 600, height: 750, crop: 'center' %}
            {% endif %}
            <div class="na-card__meta">
              <p class="na-card__title">{{ product.title }}</p>
              <p class="na-card__price">{{ product.price | money }}</p>
            </div>
          </a>
          {% endfor %}
        </div>
        {% else %}
          <p>No products found.</p>
        {% endif %}
      </div>

      <div class="na__panel" data-panel="accessories">
        {% if accColl and acc_count > 0 %}
        <div class="na__grid">
          {% for product in accColl.products limit: section.settings.limit %}
          <a class="na-card" href="{{ product.url }}">
            {% if product.featured_image %}
              {% render 'image', class: 'na-card__img', image: product.featured_image, width: 600, height: 750, crop: 'center' %}
            {% endif %}
            <div class="na-card__meta">
              <p class="na-card__title">{{ product.title }}</p>
              <p class="na-card__price">{{ product.price | money }}</p>
            </div>
          </a>
          {% endfor %}
        </div>
        {% else %}
          <p>No products found.</p>
        {% endif %}
      </div>
    </div>
  </div>

  <script>
    (function(){
      var root = document.currentScript && document.currentScript.previousElementSibling ? document.currentScript.parentElement : document.querySelector('.new-arrivals');
      if (!root) return;
      var tabs = root.querySelectorAll('.na__tab');
      var panels = root.querySelectorAll('.na__panel');
      tabs.forEach(function(tab){
        tab.addEventListener('click', function(){
          var id = tab.getAttribute('data-tab');
          tabs.forEach(function(t){ t.classList.remove('is-active'); t.setAttribute('aria-selected', 'false'); });
          panels.forEach(function(p){ p.classList.remove('is-active'); });
          tab.classList.add('is-active'); tab.setAttribute('aria-selected', 'true');
          var active = root.querySelector('.na__panel[data-panel="' + id + '"]');
          if (active) active.classList.add('is-active');
        });
      });
    })();
  </script>
</section>

{% stylesheet %}
  .na__inner { display: grid; grid-template-columns: 1fr; padding: 40px 24px; }
  .na__inner > * { grid-column: 1; }
  .na__head { display: grid; grid-template-columns: 1fr auto; align-items: end; gap: 16px; margin: 0 auto 10px; max-width: 1200px; width: 100%; }
  .na__head-left { display: grid; gap: 6px; }
  .na__title { margin: 0; font-size: 2rem; font-weight: 900; }
  .na__subtitle { margin: 0; color: #374151; }
  .na__head-ctas { display: inline-flex; gap: 10px; }
  .na__cta { text-decoration: none; font-weight: 800; letter-spacing: .5px; padding: 10px 14px; border-radius: 10px; color: #fff; background: linear-gradient(90deg, var(--brand-600), var(--brand-700)); }
  .na__cta + .na__cta { background: linear-gradient(90deg, var(--accent-500), var(--accent-600)); }

  .na__tabs { display: flex; gap: 24px; border-bottom: 2px solid var(--neutral-300); margin: 16px auto 0; max-width: 1200px; width: 100%; }
  .na__tab { appearance: none; background: transparent; color: #111; border: 0; padding: 10px 0; cursor: pointer; font-weight: 800; position: relative; text-transform: uppercase; letter-spacing: .5px; }
  .na__tab.is-active::after { content: ""; position: absolute; left: 0; right: 0; bottom: -2px; height: 3px; background: linear-gradient(90deg, var(--brand-600), var(--brand-700)); }
  .na__panels { margin: 12px auto 0; max-width: 1200px; width: 100%; }
  .na__panel { display: none; }
  .na__panel.is-active { display: block; }
  .na__grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
  .na-card { display: flex; flex-direction: column; text-decoration: none; color: inherit; background: #fff; border: 1px solid var(--neutral-300); border-radius: 12px; overflow: hidden; box-shadow: var(--shadow-md); transition: transform .15s ease, box-shadow .2s; }
  .na-card:hover { transform: translateY(-2px); }
  .na-card__meta { padding: 10px; display: flex; justify-content: space-between; align-items: center; }
  .na-card__title { margin: 0; font-weight: 700; font-size: .95rem; }
  .na-card__price { margin: 0; font-weight: 800; color: var(--brand-700); }
{% endstylesheet %}

{% schema %}
{
  "name": "New Arrivals (Tabbed)",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "New Arrivals" },
    { "type": "textarea", "id": "subheading", "label": "Subheading", "default": "Fresh picks just landed. Explore the latest for everyone." },
    { "type": "url", "id": "shop_women_link", "label": "Shop womens link" },
    { "type": "text", "id": "shop_women_label", "label": "Shop womens label", "default": "SHOP WOMENS" },
    { "type": "url", "id": "shop_men_link", "label": "Shop mens link" },
    { "type": "text", "id": "shop_men_label", "label": "Shop mens label", "default": "SHOP MENS" },
    { "type": "collection", "id": "men_collection", "label": "Men collection" },
    { "type": "collection", "id": "women_collection", "label": "Women collection" },
    { "type": "collection", "id": "accessories_collection", "label": "Accessories collection" },
    { "type": "text", "id": "men_label", "label": "Men tab label", "default": "Men" },
    { "type": "text", "id": "women_label", "label": "Women tab label", "default": "Women" },
    { "type": "text", "id": "accessories_label", "label": "Accessories tab label", "default": "Accessories" },
    { "type": "range", "id": "limit", "min": 4, "max": 12, "step": 1, "default": 8, "label": "Products to show" }
  ],
  "presets": [ { "name": "New Arrivals (Tabbed)" } ]
}
{% endschema %}


